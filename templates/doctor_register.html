{% extends 'base.html' %}

{% block title %}Doctor Register — Healix{% endblock %}

{% block content %}
  <div class="form-card mx-auto" style="max-width:520px">
    <h2 class="mb-1">Doctor — Create account</h2>
    <form id="form">
      <label class="form-label">Full name
        <input class="form-control" type="text" name="full_name" />
      </label>
      <label class="form-label">Email
        <input class="form-control" type="email" name="email" required />
      </label>
      <label class="form-label">Password
        <input class="form-control" type="password" name="password" required />
      </label>
      <label class="form-label">Hospital/Clinic
        <input class="form-control" type="text" name="hospital" />
      </label>
      <label class="form-label">Speciality
        <input class="form-control" type="text" name="speciality" />
      </label>
      <div class="mt-4">
        <button class="btn btn-primary" type="submit">Create account</button>
      </div>
    </form>
    <p id="msg" class="mt-3"></p>
    <p class="mt-3 text-muted"><a href="/doctor/login">Already have an account? Sign in</a></p>
  </div>
{% endblock %}

{% block scripts %}
<script>
const form = document.getElementById('form');
const msg = document.getElementById('msg');
form.addEventListener('submit', async (e)=>{
  e.preventDefault();
  const data = {
    full_name: form.full_name.value,
    email: form.email.value,
    password: form.password.value,
    hospital: form.hospital.value,
    speciality: form.speciality.value,
  };
  const res = await fetch('/api/doctor/register', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(data)});
  const j = await res.json();
  if(res.ok && j.success){
    msg.textContent = 'Account created. Redirecting...';
    setTimeout(()=> location.href = '/doctor/dashboard', 600);
  } else {
    msg.textContent = j.message || 'Registration failed';
  }
});
</script>
{% endblock %}
